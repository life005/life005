const N=function(e,t,n,r,i){const c=d(t);return $(e)?c.call(i,e,n,r):!1},d=function(e){if(e==null)return M;if(typeof e=="string")return K(e);if(typeof e=="object")return C(e);if(typeof e=="function")return x(e);throw new Error("Expected function, string, or array as `test`")};function C(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=d(e[n]);return x(r);function r(...i){let c=-1;for(;++c<t.length;)if(t[c].apply(this,i))return!0;return!1}}function K(e){return x(t);function t(n){return n.tagName===e}}function x(e){return t;function t(n,r,i){return!!($(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function M(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="element"&&"tagName"in e&&typeof e.tagName=="string")}function $(e){return e!==null&&typeof e=="object"&&"type"in e&&"tagName"in e}const A=d(function(e){return e.tagName==="audio"||e.tagName==="canvas"||e.tagName==="embed"||e.tagName==="iframe"||e.tagName==="img"||e.tagName==="math"||e.tagName==="object"||e.tagName==="picture"||e.tagName==="svg"||e.tagName==="video"}),U=/[ \t\n\f\r]/g;function b(e){return typeof e=="object"?e.type==="text"?B(e.value):!1:B(e)}function B(e){return e.replace(U,"")===""}const v=function(e){if(e==null)return G;if(typeof e=="function")return w(e);if(typeof e=="object")return Array.isArray(e)?X(e):z(e);if(typeof e=="string")return D(e);throw new Error("Expected function, string, or object as test")};function X(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=v(e[n]);return w(r);function r(...i){let c=-1;for(;++c<t.length;)if(t[c].apply(this,i))return!0;return!1}}function z(e){const t=e;return w(n);function n(r){const i=r;let c;for(c in e)if(i[c]!==t[c])return!1;return!0}}function D(e){return w(t);function t(n){return n&&n.type===e}}function w(e){return t;function t(n,r,i){return!!(H(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function G(){return!0}function H(e){return e!==null&&typeof e=="object"&&"type"in e}const J=["address","article","aside","blockquote","body","br","caption","center","col","colgroup","dd","dialog","dir","div","dl","dt","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","legend","li","li","listing","main","menu","nav","ol","optgroup","option","p","plaintext","pre","section","summary","table","tbody","td","td","tfoot","th","th","thead","tr","ul","wbr","xmp"],Q=["button","input","select","textarea"],V=["area","base","basefont","dialog","datalist","head","link","meta","noembed","noframes","param","rp","script","source","style","template","track","title"],Y={},S=v(["comment","doctype"]);function Z(e,t){I(e,{collapse:ae((t||Y).newlines?re:ie),whitespace:"normal"})}function I(e,t){if("children"in e){const n={...t};return(e.type==="root"||W(e))&&(n.before=!0,n.after=!0),n.whitespace=ce(e,t),ee(e,n)}if(e.type==="text"){if(t.whitespace==="normal")return _(e,t);t.whitespace==="nowrap"&&(e.value=t.collapse(e.value))}return{ignore:S(e),stripAtStart:!1,remove:!1}}function _(e,t){const n=t.collapse(e.value),r={ignore:!1,stripAtStart:!1,remove:!1};let i=0,c=n.length;return t.before&&E(n.charAt(0))&&i++,i!==c&&E(n.charAt(c-1))&&(t.after?c--:r.stripAtStart=!0),i===c?r.remove=!0:e.value=n.slice(i,c),r}function ee(e,t){let n=t.before;const r=t.after,i=e.children;let c=i.length,a=-1;for(;++a<c;){const p=I(i[a],{...t,after:O(i,a,r),before:n});p.remove?(i.splice(a,1),a--,c--):p.ignore||(n=p.stripAtStart),T(i[a])&&(n=!1)}return{ignore:!1,stripAtStart:!!(n||r),remove:!1}}function O(e,t,n){for(;++t<e.length;){const r=e[t];let i=te(r);if(i===void 0&&"children"in r&&!ne(r)&&(i=O(r.children,-1)),typeof i=="boolean")return i}return n}function te(e){if(e.type==="element"){if(T(e))return!1;if(W(e))return!0}else if(e.type==="text"){if(!b(e))return!1}else if(!S(e))return!1}function T(e){return A(e)||N(e,Q)}function W(e){return N(e,J)}function ne(e){return!!(e.type==="element"&&e.properties.hidden)||S(e)||N(e,V)}function E(e){return e===" "||e===`
`}function re(e){const t=/\r?\n|\r/.exec(e);return t?t[0]:" "}function ie(){return" "}function ae(e){return t;function t(n){return String(n).replace(/[\t\n\v\f\r ]+/g,e)}}function ce(e,t){if("tagName"in e&&e.properties)switch(e.tagName){case"listing":case"plaintext":case"script":case"style":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return e.properties.wrap?"pre-wrap":"pre";case"td":case"th":return e.properties.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}return t.whitespace}const oe={}.hasOwnProperty;function le(e,t){const n=e.type==="element"&&oe.call(e.properties,t)&&e.properties[t];return n!=null&&n!==!1}const fe=new Set(["pingback","prefetch","stylesheet"]);function ue(e){if(e.type!=="element"||e.tagName!=="link")return!1;if(e.properties.itemProp)return!0;const t=e.properties.rel;let n=-1;if(!Array.isArray(t)||t.length===0)return!1;for(;++n<t.length;)if(!fe.has(String(t[n])))return!1;return!0}const se=d(["a","abbr","area","b","bdi","bdo","br","button","cite","code","data","datalist","del","dfn","em","i","input","ins","kbd","keygen","label","map","mark","meter","noscript","output","progress","q","ruby","s","samp","script","select","small","span","strong","sub","sup","template","textarea","time","u","var","wbr"]),pe=d("meta");function he(e){return!!(e.type==="text"||se(e)||A(e)||ue(e)||pe(e)&&le(e,"itemProp"))}const ye=["pre","script","style","textarea"];const L=[],me=!0,F=!1,R="skip";function ge(e,t,n,r){let i;typeof t=="function"&&typeof n!="function"?(r=n,n=t):i=t;const c=v(i),a=r?-1:1;p(e,void 0,[])();function p(o,f,u){const l=o&&typeof o=="object"?o:{};if(typeof l.type=="string"){const h=typeof l.tagName=="string"?l.tagName:typeof l.name=="string"?l.name:void 0;Object.defineProperty(s,"name",{value:"node ("+(o.type+(h?"<"+h+">":""))+")"})}return s;function s(){let h=L,m,y,j;if((!t||c(o,f,u[u.length-1]||void 0))&&(h=de(n(o,u)),h[0]===F))return h;if("children"in o&&o.children){const g=o;if(g.children&&h[0]!==R)for(y=(r?g.children.length:-1)+a,j=u.concat(g);y>-1&&y<g.children.length;){const q=g.children[y];if(m=p(q,y,j)(),m[0]===F)return m;y=typeof m[1]=="number"?m[1]:y+a}}return h}}}function de(e){return Array.isArray(e)?e:typeof e=="number"?[me,e]:e==null?L:[e]}const be={};function we(e,t){const n=t||be,r={blanks:n.blanks||[],head:!1,indentInitial:n.indentInitial!==!1,indent:typeof n.indent=="number"?" ".repeat(n.indent):typeof n.indent=="string"?n.indent:"  "};Z(e,{newlines:!0}),ge(e,i);function i(a,p){if(!("children"in a))return;if(a.type==="element"&&a.tagName==="head"&&(r.head=!0),r.head&&a.type==="element"&&a.tagName==="body"&&(r.head=!1),a.type==="element"&&ye.includes(a.tagName))return R;if(a.children.length===0||!k(r,a))return;let o=p.length;r.indentInitial||o--;let f=!1;for(const s of a.children)(s.type==="comment"||s.type==="text")&&(s.value.includes(`
`)&&(f=!0),s.value=s.value.replace(/ *\n/g,"$&"+r.indent.repeat(o)));const u=[];let l;for(const s of a.children)(k(r,s)||f&&!l)&&(c(u,o,s),f=!0),l=s,u.push(s);l&&(f||k(r,l))&&(b(l)&&(u.pop(),l=u[u.length-1]),c(u,o-1)),a.children=u}function c(a,p,o){const f=a[a.length-1],u=f&&b(f)?a[a.length-2]:f,l=(P(r,u)&&P(r,o)?`

`:`
`)+r.indent.repeat(Math.max(p,0));f&&f.type==="text"?f.value=b(f)?l:f.value+l:a.push({type:"text",value:l})}}function P(e,t){return!!(t&&t.type==="element"&&e.blanks.length>0&&e.blanks.includes(t.tagName))}function k(e,t){return t.type==="root"||(t.type==="element"?e.head||t.tagName==="script"||A(t)||!he(t):!1)}function ke(e){return function(t){we(t,e)}}export{ke as default};
